<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="snp.app.self.SelfSocialRepository">
  
  <insert id="insertStepForm">
        INSERT INTO SOCIAL_INFO_MASTER
        (
        LOAD_DATE
        ,KPI_STEP       
         )
        VALUES
        (
        DATE_FORMAT(now(),'%Y-%m-%d')
        ,'0'
        )
    </insert>
    
     <!-- 자가진단 기본정보 업데이트 -->  
    <update id="updateStepForm">
          UPDATE SOCIAL_INFO_MASTER
        SET
         COMPANY           = #{p.COMPANY}
        ,LICENSEE           = #{p.LICENSEE}
        ,CEO_NAME           = #{p.CEO_NAME}
        ,BUSINESS_TYPE      = #{p.BS_TYPE}
        ,BS_TYPE           = #{p.BS_FORM}
        ,CITY_ZONE         = #{p.ZONE_TYPE}
        ,KPI_STEP           = '1'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update>
     
  <!-- 자가진단 스템1 업데이트 -->  
    <update id="updateStepForm1">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM1           = #{p.KPI_FORM1}
        ,KPI_FORM2           = #{p.KPI_FORM2}
        ,KPI_STEP           = '2'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    </update>
       <!-- 자가진단 스템2 업데이트 -->  
    <update id="updateStepForm2">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM3         = (#{p.KPI_FORM3_1} + #{p.KPI_FORM3_2} + #{p.KPI_FORM3_3})
        ,KPI_STEP           = '3'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update>
          <!-- 자가진단 스템3 업데이트 -->  
    <update id="updateStepForm3">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM4         = #{p.KPI_FORM4}
        ,KPI_FORM5         = #{p.KPI_FORM5}
        ,KPI_STEP           = '4'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
     
            <!-- 자가진단 스템4 업데이트 -->  
    <update id="updateStepForm4">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM6         = ( #{p.KPI_FORM6_1} + #{p.KPI_FORM6_2} + #{p.KPI_FORM6_3} )
        ,KPI_STEP           = '5'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
     
    <!-- 자가진단 스템5 업데이트 -->  
    <update id="updateStepForm5">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM7         = #{p.KPI_FORM7}
        ,KPI_STEP           = '6'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
      <!-- 자가진단 스템6 업데이트 -->  
    <update id="updateStepForm6">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM8_PAY     = REPLACE(  #{p.KPI_FORM8_PAY}, ',', '' )
        ,KPI_FORM9         = #{p.KPI_FORM9}
        ,KPI_STEP          = '7'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update>
        <!-- 자가진단 스템7 업데이트 -->  
    <update id="updateStepForm7">
          UPDATE SOCIAL_INFO_MASTER
        SET
          KPI_FORM10_PAY         = REPLACE(  #{p.KPI_FORM10_PAY}, ',', '' )
        , KPI_FORM11_PAY         = REPLACE(  #{p.KPI_FORM11_PAY}, ',', '' )
        , KPI_FORM12_PAY         = REPLACE(  #{p.KPI_FORM12_PAY}, ',', '' )                     
        ,KPI_STEP           = '8'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update>
            <!-- 자가진단 스템8 업데이트 -->  
    <update id="updateStepForm8">
          UPDATE SOCIAL_INFO_MASTER
        SET
         KPI_FORM13        = ( #{p.KPI_FORM13_1} + #{p.KPI_FORM13_2} + #{p.KPI_FORM13_3} + #{p.KPI_FORM13_4})
        ,KPI_FORM8         = #{p.KPI_PAY_N}
        ,KPI_FORM10        = #{p.KPI_HERE_N}
        ,KPI_FORM11        = #{p.KPI_SALES_N}
        ,KPI_FORM12        = #{p.KPI_BS_N}  
        ,KPI_FORM15        = #{p.KPI_WORK_N} 
        ,KPI_TOTAL        = (#{p.TOTAL_POINT} + #{p.KPI_FORM13_1} + #{p.KPI_FORM13_2} + #{p.KPI_FORM13_3} + #{p.KPI_FORM13_4})  
        ,KPI_STEP           = '9'
        ,END_DATE =  DATE_FORMAT(now(),'%Y-%m-%d.%H%i')
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
      <!-- 자가진단 스템8 업데이트 -->  
    <update id="updateStepForm9">
          UPDATE SOCIAL_INFO_MASTER
        SET   
        KPI_STEP    = '10'
        ,KPI_AND    =  'Y'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NOT NULL
    
     </update>               
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack1">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '0'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
           <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack2">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '1'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack3">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '2'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack4">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '3'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack5">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '4'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack6">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '5'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack7">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '6'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
          <!-- 자가진단 스템 -1 업데이트 -->  
    <update id="updateStepBack8">
          UPDATE SOCIAL_INFO_MASTER
        SET
        KPI_STEP    = '7'
        WHERE KPI_SEQ  = #{p.KPI_SEQ}
        AND END_DATE IS NULL
    
     </update> 
    
    <!-- 자가진단 스템1 목록 -->
    <select id="findstepList1" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='0'
		AND END_DATE IS NULL
		order by KPI_SEQ desc limit 1
    </select>
    
   <!-- 자가진단 스템2 목록 -->
    <select id="findstepList2" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='1'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select>
    
   <!-- 자가진단 스템3 목록 -->
    <select id="findstepList3" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='2'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select>  
      <!-- 자가진단 스템4 목록 -->
    <select id="findstepList4" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='3'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select>  
       <!-- 자가진단 스템5 목록 -->
    <select id="findstepList5" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='4'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select> 
         <!-- 자가진단 스템6 목록 -->
    <select id="findstepList6" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='5'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select> 
        <!-- 자가진단 스템7 목록 -->
    <select id="findstepList7" resultType="hashmap">
 	SELECT 
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM8_PAY
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM11
		,KPI_FORM12
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
	FROM  SOCIAL_INFO_MASTER
		WHERE 1=1
		 AND KPI_STEP ='6'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select>
       <select id="findstepList8" resultType="hashmap">
  select 
		cnt.KPI_SEQ
		,cnt.COMPANY
		,cnt.LICENSEE
		,cnt.CEO_NAME
		,cnt.BUSINESS_TYPE
		,cnt.BS_TYPE
		,cnt.CITY_ZONE
		,cnt.KPI_FORM1
		,cnt.KPI_FORM2
		,cnt.KPI_FORM3
		,cnt.KPI_FORM4
		,cnt.KPI_FORM5
		,cnt.KPI_FORM6
		,cnt.KPI_FORM7
		,cnt.KPI_FORM8
		,cnt.KPI_FORM8_PAY
		,cnt.KPI_FORM9
		,cnt.KPI_FORM10
		,cnt.KPI_FORM10_PAY
		,cnt.KPI_FORM11
		,cnt.KPI_FORM11_PAY
		,cnt.KPI_FORM12
		,cnt.KPI_FORM12_PAY
		,cnt.KPI_FORM13
		,cnt.KPI_FORM14
		,cnt.KPI_FORM15
		,cnt.KPI_STEP
		,cnt.LOAD_DATE
		,cnt.END_DATE
		,(cnt.KPI_FORM11_PAY DIV cnt.KPI_FORM10_PAY) AS hier_num
		,KPI_WORK_P
		,KPI_WORK_N
		,KPI_PAY_P
		,KPI_PAY_N
		,KPI_HERE_P
		,KPI_HERE_N
		,KPI_SALES_P
		,KPI_SALES_N
		,KPI_BS_P
		,KPI_BS_N
,(KPI_FORM1+KPI_FORM2+KPI_FORM3+KPI_FORM4+KPI_FORM5+KPI_FORM6+KPI_FORM7+KPI_PAY_N+KPI_FORM9+KPI_HERE_N+KPI_SALES_N+KPI_BS_N+KPI_WORK_N)AS TOTAL_POINT  
FROM(
SELECT
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM8_PAY
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM10_PAY
		,KPI_FORM11
		,KPI_FORM11_PAY
		,KPI_FORM12
		,KPI_FORM12_PAY
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
		,(KPI_FORM11_PAY DIV KPI_FORM10_PAY) AS hier_num
		,(select SERVICE_PERCENT
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_WORK_SALES ' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - (a.KPI_FORM11_PAY DIV a.KPI_FORM10_PAY)) limit 1
		) AS KPI_WORK_P
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_WORK_SALES ' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - (a.KPI_FORM11_PAY DIV a.KPI_FORM10_PAY)) limit 1
		) AS KPI_WORK_N
		,(select SERVICE_PERCENT
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_PAY' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM8_PAY) limit 1
		) AS KPI_PAY_P
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_PAY' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM8_PAY) limit 1
		) AS KPI_PAY_N
		,(select SERVICE_PERCENT
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_HIRE' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM10_PAY) limit 1
		) AS KPI_HERE_P
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_HIRE' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM10_PAY) limit 1
		) AS KPI_HERE_N
		,(select SERVICE_PERCENT
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM11_PAY) limit 1
		) AS KPI_SALES_P
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM11_PAY) limit 1
		) AS KPI_SALES_N
		,(select SERVICE_PERCENT
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_BS_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM12_PAY) limit 1
		) AS KPI_BS_P
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and (b.GRP_CD ='SERVICE_BS_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM12_PAY) limit 1
		) AS KPI_BS_N
		from social_info_master
		where 1=1
		 AND KPI_STEP ='7'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
		)cnt 
    </select>
       <select id="findstepList9" resultType="hashmap">
  select 
		cnt.KPI_SEQ
		,cnt.COMPANY
		,cnt.LICENSEE
		,cnt.CEO_NAME
		,cnt.BUSINESS_TYPE
		,cnt.BS_TYPE
		,cnt.CITY_ZONE
		,cnt.KPI_FORM1
		,cnt.KPI_FORM2
		,cnt.KPI_FORM3
		,cnt.KPI_FORM4
		,cnt.KPI_FORM5
		,cnt.KPI_FORM6
		,cnt.KPI_FORM7
		,cnt.KPI_FORM8
		,cnt.KPI_FORM8_PAY
		,cnt.KPI_FORM9
		,cnt.KPI_FORM10
		,cnt.KPI_FORM10_PAY
		,cnt.KPI_FORM11
		,cnt.KPI_FORM11_PAY
		,cnt.KPI_FORM12
		,cnt.KPI_FORM12_PAY
		,cnt.KPI_FORM13
		,cnt.KPI_FORM14
		,cnt.KPI_FORM15
		,cnt.KPI_STEP
		,cnt.LOAD_DATE
		,cnt.END_DATE
		,(cnt.KPI_FORM11_PAY DIV cnt.KPI_FORM10_PAY) AS hier_num
		,KPI_WORK_N
		,KPI_PAY_N
		,KPI_HERE_N
		,KPI_SALES_N
		,KPI_BS_N
,(KPI_FORM1+KPI_FORM2+KPI_FORM3+KPI_FORM4+KPI_FORM5+KPI_FORM6+KPI_FORM7+KPI_PAY_N+KPI_FORM9+KPI_HERE_N+KPI_SALES_N+KPI_BS_N+KPI_WORK_N)AS TOTAL_POINT  
FROM(
SELECT
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM8_PAY
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM10_PAY
		,KPI_FORM11
		,KPI_FORM11_PAY
		,KPI_FORM12
		,KPI_FORM12_PAY
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
		,(KPI_FORM11_PAY DIV KPI_FORM10_PAY) AS hier_num
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL		
		and (b.GRP_CD ='SERVICE_WORK_SALES ' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - (a.KPI_FORM11_PAY DIV a.KPI_FORM10_PAY)) desc limit 1
		) AS KPI_WORK_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL		
		and (b.GRP_CD ='SERVICE_PAY' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM8_PAY) desc limit 1
		) AS KPI_PAY_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL		
		and (b.GRP_CD ='SERVICE_HIRE' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM10_PAY) desc limit 1
		) AS KPI_HERE_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL		
		and (b.GRP_CD ='SERVICE_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM11_PAY) desc limit 1
		) AS KPI_SALES_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL		
		and (b.GRP_CD ='SERVICE_BS_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM12_PAY) desc limit 1
		) AS KPI_BS_N
		from social_info_master
		where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
		)cnt 
		 where 1=1
		 AND KPI_STEP ='8'
		 AND END_DATE IS NULL
		 order by KPI_SEQ desc limit 1
    </select>   
  <select id="resultStepList" resultType="hashmap">
  select 
		cnt.KPI_SEQ
		,cnt.COMPANY
		,cnt.LICENSEE
		,cnt.CEO_NAME
		,cnt.BUSINESS_TYPE
		,cnt.BS_TYPE
		,cnt.CITY_ZONE
		,cnt.KPI_FORM1
		,cnt.KPI_FORM2
		,cnt.KPI_FORM3
		,cnt.KPI_FORM4
		,cnt.KPI_FORM5
		,cnt.KPI_FORM6
		,cnt.KPI_FORM7
		,cnt.KPI_FORM8
		,cnt.KPI_FORM8_PAY
		,cnt.KPI_FORM9
		,cnt.KPI_FORM10
		,cnt.KPI_FORM10_PAY
		,cnt.KPI_FORM11
		,cnt.KPI_FORM11_PAY
		,cnt.KPI_FORM12
		,cnt.KPI_FORM12_PAY
		,cnt.KPI_FORM13
		,cnt.KPI_FORM14
		,cnt.KPI_FORM15
		,cnt.KPI_STEP
		,cnt.LOAD_DATE
		,cnt.END_DATE
		,(cnt.KPI_FORM11_PAY DIV cnt.KPI_FORM10_PAY) AS hier_num
		,KPI_WORK_N
		,KPI_PAY_N
		,KPI_HERE_N
		,KPI_SALES_N
		,KPI_BS_N
		,KPI_AND
,(KPI_FORM1+KPI_FORM2+KPI_FORM3+KPI_FORM4+KPI_FORM5+KPI_FORM6+KPI_FORM7+KPI_PAY_N+KPI_FORM9+KPI_HERE_N+KPI_SALES_N+KPI_BS_N+KPI_WORK_N+KPI_FORM13)AS TOTAL_POINT  
FROM(
SELECT
		KPI_SEQ
		,COMPANY
		,LICENSEE
		,CEO_NAME
		,BUSINESS_TYPE
		,BS_TYPE
		,CITY_ZONE
		,KPI_FORM1
		,KPI_FORM2
		,KPI_FORM3
		,KPI_FORM4
		,KPI_FORM5
		,KPI_FORM6
		,KPI_FORM7
		,KPI_FORM8
		,KPI_FORM8_PAY
		,KPI_FORM9
		,KPI_FORM10
		,KPI_FORM10_PAY
		,KPI_FORM11
		,KPI_FORM11_PAY
		,KPI_FORM12
		,KPI_FORM12_PAY
		,KPI_FORM13
		,KPI_FORM14
		,KPI_FORM15
		,KPI_STEP
		,LOAD_DATE
		,END_DATE
		,KPI_AND
		,(KPI_FORM11_PAY DIV KPI_FORM10_PAY) AS hier_num
		,(select  SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL		
		and (b.GRP_CD ='SERVICE_WORK_SALES ' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - (a.KPI_FORM11_PAY DIV a.KPI_FORM10_PAY)) desc  limit 1
		) AS KPI_WORK_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL		
		and (b.GRP_CD ='SERVICE_PAY' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM8_PAY) desc limit 1
		) AS KPI_PAY_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL		
		and (b.GRP_CD ='SERVICE_HIRE' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM10_PAY) desc limit 1
		) AS KPI_HERE_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL		
		and (b.GRP_CD ='SERVICE_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM11_PAY) desc limit 1
		) AS KPI_SALES_N
		,(select SERVICE_NUM
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL		
		and (b.GRP_CD ='SERVICE_BS_SALES' and a.BUSINESS_TYPE = b.SERVICE_TYPE)
		order by abs(b.SERVICE_STANDARD - a.KPI_FORM12_PAY) desc limit 1
		) AS KPI_BS_N	
		from social_info_master
		where 1=1
		 AND KPI_STEP ='9'
		 AND END_DATE IS NOT NULL
		 order by KPI_SEQ desc limit 1
		)cnt
		where 1=1 
	   AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		AND KPI_AND ='N'
		order by KPI_SEQ desc limit 1  
    </select>   
  
   
    <select id="resultSteptop" resultType="hashmap">
      <![CDATA[ 
		select  GROUP_CONCAT(DISTINCT cnt.ROW_LIST  SEPARATOR ' , ')AS TOP_LIST
		from(
		 select B.GRP_NM AS ROW_LIST,a.KPI_SEQ,a.END_DATE,a.KPI_AND,a.KPI_STEP
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and( 
		(b.SERVICE_NM='KPI_FORM1' and b.GRP_CD ='SERVICE_INFO' and a.KPI_FORM1 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM2' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM2 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM3' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM3 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM4' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM4 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM5' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM5 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM6' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM6 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM7' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM7 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM9' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM9 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM13' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM13 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM8' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM8  >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM10' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM10 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM11' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM11 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM12' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM12 >= b.SERVICE_NUM)
		or (b.SERVICE_NM='KPI_FORM15' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM15 >= b.SERVICE_NUM)
		)
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		AND KPI_AND ='N'
		AND KPI_SEQ = (select KPI_SEQ from social_info_master order by KPI_SEQ desc limit 1)	
		)cnt
		]]>		
   </select> 
   <select id="resultSteplow" resultType="hashmap"> 
  <![CDATA[ 
		select  GROUP_CONCAT(DISTINCT cnt.ROW_LIST  SEPARATOR ' , ')AS LOW_LIST
		from(
		 select B.GRP_NM AS ROW_LIST,a.KPI_SEQ,a.END_DATE,a.KPI_AND,a.KPI_STEP
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and( 
	    (b.SERVICE_NM='KPI_FORM1' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM1 < b.SERVICE_STANDARD )
		or (b.SERVICE_NM='KPI_FORM2' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM2 < b.SERVICE_STANDARD )
		or (b.SERVICE_NM='KPI_FORM3' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM3 < b.SERVICE_STANDARD )
		or (b.SERVICE_NM='KPI_FORM4' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM4 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM5' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM5 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM6' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM6 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM7' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM7 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM9' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM9 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM13' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM13 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM8' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM8  < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM10' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM10 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM11' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM11 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM12' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM12 < b.SERVICE_STANDARD)
		or (b.SERVICE_NM='KPI_FORM15' and b.GRP_CD ='SERVICE_INFO'  and a.KPI_FORM15 < b.SERVICE_STANDARD)
		) 
	   AND KPI_STEP ='9'
	   AND END_DATE IS NOT NULL
	   AND KPI_AND ='N'
	   AND KPI_SEQ = (select KPI_SEQ from social_info_master order by KPI_SEQ desc limit 1)
	   )cnt	
	]]>	
  </select>
  <select id="resultMent" resultType="hashmap">
     select 
		*
		from(
        select *
		from social_info_master a,
		serviceinfo_code_standard b
		where 1=1
		and b.GRP_CD ='SERVICE_POINT'
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		and abs(b.SERVICE_NUM - a.KPI_TOTAL)   
		order by KPI_SEQ desc limit 1
		)cnt
		where 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
  </select>		
	<!-- 참여기업 결과 리스트-->
	<select id="gridCorp" resultType="hashmap">
		SELECT
			COMPANY,
			LICENSEE,
			CEO_NAME,
			(SELECT GRP_NM FROM SERVICEINFO_CODE_STANDARD WHERE GRP_CD = 'SERVICE_CODE' AND CD = BUSINESS_TYPE) AS BUSINESS_TYPE,
			BS_TYPE,
			CITY_ZONE,
			KPI_FORM1+KPI_FORM2+KPI_FORM3+KPI_FORM4+KPI_FORM5+KPI_FORM6+KPI_FORM7+KPI_FORM8+
			KPI_FORM9+KPI_FORM10+KPI_FORM11+KPI_FORM12+KPI_FORM13+KPI_FORM15 AS RESULT,
			substr(LOAD_DATE,1,10) AS LOAD_DATE
		FROM SOCIAL_INFO_MASTER
		ORDER BY  LOAD_DATE DESC
	</select>
	<!-- 챠트 동종업계평균-->
  <select id="chartAllGradeSocial" resultType="hashmap">
	select STATUS,RESULT
		from(
		SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result a, social_info_master b
		where 1=1
		AND TOTAL_CODE ='2'
		AND TOTAL_TYPE = b.BUSINESS_TYPE
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select STATUS,RESULT
		from(
		SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result a, social_info_master b
		where 1=1
		AND TOTAL_CODE ='4'
		AND TOTAL_TYPE = b.BUSINESS_TYPE
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select STATUS,RESULT
		from(
		SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result a, social_info_master b
		where 1=1
		AND TOTAL_CODE ='6'
		AND TOTAL_TYPE = b.BUSINESS_TYPE
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select STATUS,RESULT
		from(
		SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result a, social_info_master b
		where 1=1
		AND TOTAL_CODE ='8'
		AND TOTAL_TYPE = b.BUSINESS_TYPE
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
   </select>
   <!-- 챠트 전체평균점수-->
   	<select id="chartAllGradeTotal" resultType="hashmap">
	SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result
		where 1=1
		AND TOTAL_CODE ='1'
		AND TOTAL_TYPE= '1'
		UNION ALL
	SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result
		where 1=1
		AND TOTAL_CODE ='3'
		AND TOTAL_TYPE= '1'
		UNION ALL
	SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result
		where 1=1
		AND TOTAL_CODE ='5'
		AND TOTAL_TYPE= '1'
		UNION ALL
	SELECT TOTAL_STANDAR  AS STATUS, TOTAL_AVERAGE AS RESULT
		FROM social_total_result
		where 1=1
		AND TOTAL_CODE ='7'
		AND TOTAL_TYPE= '1'
   </select>
   <!-- 챠트 귀사평균점수-->
   <select id="chartAllGradeMyTotal" resultType="hashmap">
	 select RESULT
		from(
		SELECT KPI_TOTAL AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM1+KPI_FORM2+KPI_FORM3+KPI_FORM4+KPI_FORM5+KPI_FORM6+KPI_FORM7+KPI_FORM8+KPI_FORM9) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM10+KPI_FORM11+KPI_FORM12+KPI_FORM15) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM13) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt  
  
   
     </select> 
      <!-- 챠트 귀사평균점수-->
   <select id="chartAllraderSocial" resultType="hashmap">
	select RESULT
		from(
		SELECT (KPI_FORM1 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM2 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM3 * 10)  AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM4 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM5 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM6 * 10)  AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM7 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM8 * 10) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM9 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT ( KPI_FORM10 * 10) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM11 * 10) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT ( KPI_FORM12 * 10)  AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM15 * 20) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1 
		)cnt
		UNION ALL
	select RESULT
		from(
		SELECT (KPI_FORM13 * 10) AS RESULT
		FROM SOCIAL_INFO_MASTER
		WHERE 1=1
		AND KPI_STEP ='9'
		AND END_DATE IS NOT NULL
		order by KPI_SEQ desc limit 1
		)cnt  
    </select>
    
</mapper>
